<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Equipment Monitoring Dashboard</h1>
    <p class="subtitle">Real-time predictive maintenance insights</p>
  </div>

  <div class="status-summary">
    <mat-card class="status-card operational animate-in" (click)="filterByStatus('Operational')">
      <mat-card-content>
        <div class="status-icon"><mat-icon>check_circle</mat-icon></div>
        <div class="status-count">{{ getStatusCount('Operational') }}</div>
        <div class="status-label">Operational</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="status-card warning animate-in" (click)="filterByStatus('Warning')" style="animation-delay: 0.1s">
      <mat-card-content>
        <div class="status-icon"><mat-icon>warning</mat-icon></div>
        <div class="status-count">{{ getStatusCount('Warning') }}</div>
        <div class="status-label">Warning</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="status-card critical animate-in" (click)="filterByStatus('Critical')" style="animation-delay: 0.2s">
      <mat-card-content>
        <div class="status-icon"><mat-icon>error</mat-icon></div>
        <div class="status-count">{{ getStatusCount('Critical') }}</div>
        <div class="status-label">Critical</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="status-card under-maintenance animate-in" (click)="filterByStatus('UnderMaintenance')" style="animation-delay: 0.3s">
      <mat-card-content>
        <div class="status-icon"><mat-icon>build</mat-icon></div>
        <div class="status-count">{{ getStatusCount('UnderMaintenance') }}</div>
        <div class="status-label">Under Maintenance</div>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="dashboard-grid">
    <div class="grid-item large">
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>
            <div class="header-with-icon">
              <mat-icon>monitoring</mat-icon>
              <span>Equipment Health Overview</span>
            </div>
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="health-chart" id="healthChart"></div>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="grid-item">
      <mat-card>
        <mat-card-header>
          <mat-card-title>
            <div class="header-with-icon">
              <mat-icon>event</mat-icon>
              <span>Upcoming Maintenance</span>
            </div>
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="maintenance-list">
            <div class="maintenance-item" *ngFor="let event of upcomingMaintenance">
              <div class="event-date">{{ event.date | date:'MMM d' }}</div>
              <div class="event-details">
                <div class="event-title">{{ event.equipment }}</div>
                <div class="event-type">{{ event.type }} Maintenance</div>
              </div>
              <div class="event-priority" [ngClass]="'priority-' + event.priority.toLowerCase()">
                {{ event.priority }}
              </div>
            </div>
            <div class="view-all-link">
              <a routerLink="/maintenance">View all scheduled maintenance â†’</a>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="grid-item">
      <mat-card>
        <mat-card-header>
          <mat-card-title>
            <div class="header-with-icon">
              <mat-icon>warning_amber</mat-icon>
              <span>Recent Anomalies</span>
            </div>
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="anomaly-list">
            <div class="anomaly-item" *ngFor="let anomaly of recentAnomalies">
              <div class="anomaly-icon">
                <mat-icon [ngClass]="'severity-' + anomaly.severity.toLowerCase()">
                  {{ getSeverityIcon(anomaly.severity) }}
                </mat-icon>
              </div>
              <div class="anomaly-details">
                <div class="anomaly-title">{{ anomaly.equipment }} - {{ anomaly.sensor }}</div>
                <div class="anomaly-time">{{ anomaly.time | date:'MMM d, h:mm a' }}</div>
              </div>
              <div class="anomaly-value">{{ anomaly.value }}{{ anomaly.unit }}</div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <h2 class="section-title">Equipment Status</h2>

  <div class="equipment-grid">
    <mat-card class="equipment-card" *ngFor="let equipment of equipmentList"
              [ngClass]="'status-' + equipment.status.toLowerCase()"
              (click)="navigateToEquipment(equipment.id)">
      <div class="equipment-icon">
        <mat-icon>{{ getEquipmentIcon(equipment.type) }}</mat-icon>
      </div>
      <div class="equipment-details">
        <h3 class="equipment-name">{{ equipment.name }}</h3>
        <p class="equipment-type">{{ equipment.type }}</p>
        <div class="equipment-stats">
          <div class="stat">
            <mat-icon class="small-icon">calendar_today</mat-icon>
            <span>{{ equipment.installationDate | date:'MMM yyyy' }}</span>
          </div>
          <div class="stat">
            <mat-icon class="small-icon">build</mat-icon>
            <span>{{ equipment.lastMaintenanceDate | date:'MMM d' }}</span>
          </div>
        </div>
      </div>
      <div class="equipment-status">
        <app-status-indicator [status]="equipment.status" [showLabel]="false"></app-status-indicator>
      </div>
    </mat-card>
  </div>

  <app-loading-spinner *ngIf="isLoading"></app-loading-spinner>
</div>
